
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Atmosphere model components &#8212; PISM, a Parallel Ice Sheet Model 2.0.4 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"TeX": {"Macros": {"dx": "\\Delta x", "dy": "\\Delta y", "dz": "\\Delta z", "dt": "\\Delta t", "km": "\\,\\text{km}", "Diff": [" \\frac{\\mathrm{d}#1}{\\mathrm{d}#2} ", "2"], "diff": [" \\frac{\\partial #1}{\\partial #2} ", "2"], "var": [" {#1}_{\\text{#2}} ", "2"], "h": [" \\var{h}{#1} ", "1"], "T": [" \\var{T}{#1} ", "1"], "m": [" \\var{m}{#1} ", "1"], "ms": [" \\var{m^{*}}{#1} ", "1"], "psw": "p_{\\text{water}}", "pice": "p_{\\text{ice}}", "pmelange": "\\bar p_{\\text{melange}}", "rhoi": "\\rho_{\\text{ice}}", "rhow": "\\rho_{\\text{water}}", "n": "\\boldsymbol{n}", "nx": "\\n_{x}", "ny": "\\n_{y}", "phimin": "\\phi_{\\mathrm{min}}", "phimax": "\\phi_{\\mathrm{max}}", "bmin": "b_{\\mathrm{min}}", "bmax": "b_{\\mathrm{max}}", "bq": "\\mathbf{q}", "Up": ["\\operatorname{Up}\\left(#1\\big|#2\\right)", "2"], "uppair": ["\\left\\{\\begin{matrix} #1 \\\\ #2 \\end{matrix}\\right\\}", "2"], "Div": "\\nabla \\cdot", "V": "\\mathbf{V}", "Wtill": "W_{\\mathrm{till}}", "zs": "z_{\\text{sea level}}", "uu": "\\boldsymbol{u}", "nz": "\\n_{z}", "td": ["t^{D}_{#1}", "1"], "D": "\\displaystyle", "viscosity": "\\nu", "partI": "(2\\tilde N_{xx} + \\tilde N_{yy})", "partII": "(\\tilde N_{xy})", "E": "\\dot{\\boldsymbol{\\epsilon}}", "exponent": "\\frac{1-n}{2n}", "p": ["\\left(#1\\right)", "1"], "f": "\\rho\\, g\\, \\nabla s", "Id": "\\int_{\\Omega}", "Ib": "\\int_{\\partial\\Omega}", "Ibase": "\\int_{\\text{base}}", "dphi": ["\\diff{\\varphi_{#1}}{#2}", "2", "i"], "dpsi": ["\\diff{\\psi_{#1}}{#2}", "2", "i"], "Hmin": "H_{\\text{min}}", "dbeta": "\\diff{\\beta}{\\alpha}", "K": ["K_{i,j,#1,#2}", "2"], "ELA": "h_{\\text{ELA}}", "dphimin": "\\Delta \\phi_{\\mathrm{min}}", "dphimax": "\\Delta \\phi_{\\mathrm{max}}"}}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ocean model components" href="ocean.html" />
    <link rel="prev" title="Surface mass and energy process model components" href="surface.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
<div class="documentwrapper">
  <div class="bodywrapper">
    <div class="body" role="main">
      
  <div class="section" id="atmosphere-model-components">
<h1><a class="toc-backref" href="#id25">Atmosphere model components</a><a class="headerlink" href="#atmosphere-model-components" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#atmosphere-model-components" id="id25">Atmosphere model components</a></p>
<ul>
<li><p><a class="reference internal" href="#reading-boundary-conditions-from-a-file" id="id26">Reading boundary conditions from a file</a></p></li>
<li><p><a class="reference internal" href="#cosine-yearly-cycle" id="id27">Cosine yearly cycle</a></p></li>
<li><p><a class="reference internal" href="#sec-atmosphere-searise-greenland" id="id28">SeaRISE-Greenland</a></p></li>
<li><p><a class="reference internal" href="#pik" id="id29">PIK</a></p></li>
<li><p><a class="reference internal" href="#one-weather-station" id="id30">One weather station</a></p></li>
<li><p><a class="reference internal" href="#scalar-temperature-offsets" id="id31">Scalar temperature offsets</a></p></li>
<li><p><a class="reference internal" href="#scalar-precipitation-offsets" id="id32">Scalar precipitation offsets</a></p></li>
<li><p><a class="reference internal" href="#precipitation-scaling" id="id33">Precipitation scaling</a></p></li>
<li><p><a class="reference internal" href="#precipitation-correction-using-scalar-temperature-offsets" id="id34">Precipitation correction using scalar temperature offsets</a></p></li>
<li><p><a class="reference internal" href="#adjustments-using-modeled-change-in-surface-elevation" id="id35">Adjustments using modeled change in surface elevation</a></p></li>
<li><p><a class="reference internal" href="#using-climate-data-anomalies" id="id36">Using climate data anomalies</a></p></li>
<li><p><a class="reference internal" href="#orographic-precipitation" id="id37">Orographic precipitation</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="reading-boundary-conditions-from-a-file">
<span id="sec-atmosphere-given"></span><h2><a class="toc-backref" href="#id26">Reading boundary conditions from a file</a><a class="headerlink" href="#reading-boundary-conditions-from-a-file" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">given</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">air_temp</span></code>, <code class="variable docutils literal notranslate"><span class="pre">precipitation</span></code> <span class="math notranslate nohighlight">\(kg / (m^{2} s)\)</span></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::Given</span></code></p>
</dd>
<dt class="field-even">See also</dt>
<dd class="field-even"><p><a class="reference internal" href="surface.html#sec-surface-given"><span class="std std-ref">Reading top-surface boundary conditions from a file</span></a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is the default choice.</p>
</div>
<p>A file <code class="docutils literal notranslate"><span class="pre">foo.nc</span></code> used with <code class="docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">given</span> <span class="pre">-atmosphere_given_file</span> <span class="pre">foo.nc</span></code> should
contain several records; the <code class="variable docutils literal notranslate"><span class="pre">time</span></code> variable should describe what model time these
records correspond to.</p>
<p>This model component was created to force PISM with sampled (possibly periodic) climate
data, e.g. using monthly records of <code class="variable docutils literal notranslate"><span class="pre">air_temp</span></code> and <code class="variable docutils literal notranslate"><span class="pre">precipitation</span></code>.</p>
<p>It can also used to drive a temperature-index (PDD) climatic mass balance computation
(section <a class="reference internal" href="surface.html#sec-surface-pdd"><span class="std std-ref">Temperature-index scheme</span></a>).</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">atmosphere.given.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.given.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing climate forcing fields.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.given.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
</ol>
</div>
<div class="section" id="cosine-yearly-cycle">
<span id="sec-atmosphere-yearly-cycle"></span><h2><a class="toc-backref" href="#id27">Cosine yearly cycle</a><a class="headerlink" href="#cosine-yearly-cycle" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="option docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">yearly_cycle</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">air_temp_mean_annual</span></code>,
<code class="variable docutils literal notranslate"><span class="pre">air_temp_mean_july</span></code>,
<code class="variable docutils literal notranslate"><span class="pre">precipitation</span></code> <span class="math notranslate nohighlight">\(kg / (m^{2} s)\)</span>
<code class="variable docutils literal notranslate"><span class="pre">amplitude_scaling</span></code></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::CosineYearlyCycle</span></code></p>
</dd>
</dl>
<p>This atmosphere model component computes the near-surface air temperature using the
following formula:</p>
<div class="math notranslate nohighlight">
\[T(\mathrm{time}) = T_{\text{mean annual}}
+ A(\mathrm{time})\cdot(T_{\text{mean July}} - T_{\text{mean annual}}) \cdot \cos(2\pi t),\]</div>
<p>where <span class="math notranslate nohighlight">\(t\)</span> is the year fraction “since last July”; the summer peak of the cycle is on
<a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.fausto_air_temp.summer_peak_day"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.fausto_air_temp</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.summer_peak_day</span></code></a>, which is set to day <span class="math notranslate nohighlight">\(196\)</span> by
default (approximately July 15).</p>
<p>Here <span class="math notranslate nohighlight">\(T_{\text{mean annual}}\)</span> (variable <code class="variable docutils literal notranslate"><span class="pre">air_temp_mean_annual</span></code>) and <span class="math notranslate nohighlight">\(T_{\text{mean
July}}\)</span> (variable <code class="variable docutils literal notranslate"><span class="pre">air_temp_mean_july</span></code>) are read from a file selected using the
command-line option <code class="option docutils literal notranslate"><span class="pre">-atmosphere_yearly_cycle_file</span></code>. A time-independent precipitation
field (variable <code class="variable docutils literal notranslate"><span class="pre">precipitation</span></code>) is read from the same file.</p>
<p>Optionally a time-dependent scalar amplitude scaling <span class="math notranslate nohighlight">\(A(t)\)</span> can be used. Specify a
file to read it from using the <code class="option docutils literal notranslate"><span class="pre">-atmosphere_yearly_cycle_scaling_file</span></code> command-line
option. Without this option <span class="math notranslate nohighlight">\(A(\mathrm{time}) \equiv 1\)</span>.</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">atmosphere.yearly_cycle.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.yearly_cycle.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing mean annual and mean July temperatures (<code class="variable docutils literal notranslate"><span class="pre">air_temp_mean_annual</span></code> and <code class="variable docutils literal notranslate"><span class="pre">air_temp_mean_summer</span></code>) and the <code class="variable docutils literal notranslate"><span class="pre">precipitation</span></code> field.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.yearly_cycle.scaling.file"><code class="docutils literal notranslate"><span class="pre">scaling</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a> Name of the file containing amplitude scaling (<code class="variable docutils literal notranslate"><span class="pre">amplitude_scaling</span></code>) for the near-surface air temperature.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.yearly_cycle.scaling.periodic"><code class="docutils literal notranslate"><span class="pre">scaling</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
</ol>
</div>
<div class="section" id="sec-atmosphere-searise-greenland">
<span id="id1"></span><h2><a class="toc-backref" href="#id28">SeaRISE-Greenland</a><a class="headerlink" href="#sec-atmosphere-searise-greenland" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">searise_greenland</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">lon</span></code>,
<code class="variable docutils literal notranslate"><span class="pre">lat</span></code>,
<code class="variable docutils literal notranslate"><span class="pre">precipitation</span></code> <span class="math notranslate nohighlight">\(kg / (m^{2} s)\)</span></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::SeaRISEGreenland</span></code></p>
</dd>
<dt class="field-even">See also</dt>
<dd class="field-even"><p><a class="reference internal" href="#sec-atmosphere-precip-scaling"><span class="std std-ref">Precipitation correction using scalar temperature offsets</span></a></p>
</dd>
</dl>
<p>This atmosphere model component implements a longitude, latitude, and elevation dependent
near-surface air temperature parameterization and a cosine yearly cycle described in
<a class="bibtex reference internal" href="../zzz_references_html.html#faustoetal2009" id="id2">[1]</a> and uses a constant in time ice-equivalent precipitation field (in units
of thickness per time, variable <code class="variable docutils literal notranslate"><span class="pre">precipitation</span></code>) that is read from an input (<code class="docutils literal notranslate"><span class="pre">-i</span></code>)
file. To read time-independent precipitation from a different file, use the option
<code class="option docutils literal notranslate"><span class="pre">-atmosphere_searise_greenland_file</span></code>.</p>
<p>The air temperature parameterization is controlled by configuration parameters with the
prefix <code class="docutils literal notranslate"><span class="pre">atmosphere.fausto_air_temp</span></code>:</p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.fausto_air_temp.c_ma"><code class="docutils literal notranslate"><span class="pre">c_ma</span></code></a> (-0.7189<em> Kelvin / degree_north</em>) latitude-dependence coefficient for formula (1) in <a class="bibtex reference internal" href="../zzz_references_html.html#faustoetal2009" id="id3">[1]</a></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.fausto_air_temp.c_mj"><code class="docutils literal notranslate"><span class="pre">c_mj</span></code></a> (-0.1585<em> Kelvin / degree_north</em>) latitude-dependence coefficient for formula (2) in <a class="bibtex reference internal" href="../zzz_references_html.html#faustoetal2009" id="id4">[1]</a></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.fausto_air_temp.d_ma"><code class="docutils literal notranslate"><span class="pre">d_ma</span></code></a> (314.98<em> Kelvin</em>) 41.83+273.15; base temperature for formula (1) in <a class="bibtex reference internal" href="../zzz_references_html.html#faustoetal2009" id="id5">[1]</a></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.fausto_air_temp.d_mj"><code class="docutils literal notranslate"><span class="pre">d_mj</span></code></a> (287.85<em> Kelvin</em>) = 14.70+273.15; base temperature for formula (2) in <a class="bibtex reference internal" href="../zzz_references_html.html#faustoetal2009" id="id6">[1]</a></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.fausto_air_temp.gamma_ma"><code class="docutils literal notranslate"><span class="pre">gamma_ma</span></code></a> (-0.006309<em> Kelvin / meter</em>) = -6.309 / 1km; mean slope lapse rate for formula (1) in <a class="bibtex reference internal" href="../zzz_references_html.html#faustoetal2009" id="id7">[1]</a></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.fausto_air_temp.gamma_mj"><code class="docutils literal notranslate"><span class="pre">gamma_mj</span></code></a> (-0.005426<em> Kelvin / meter</em>) = -5.426 / 1km; mean slope lapse rate for formula (2) in <a class="bibtex reference internal" href="../zzz_references_html.html#faustoetal2009" id="id8">[1]</a></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.fausto_air_temp.kappa_ma"><code class="docutils literal notranslate"><span class="pre">kappa_ma</span></code></a> (0.0672<em> Kelvin / degree_west</em>) longitude-dependence coefficient for formula (1) in <a class="bibtex reference internal" href="../zzz_references_html.html#faustoetal2009" id="id9">[1]</a></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.fausto_air_temp.kappa_mj"><code class="docutils literal notranslate"><span class="pre">kappa_mj</span></code></a> (0.0518<em> Kelvin / degree_west</em>) longitude-dependence coefficient for formula (2) in <a class="bibtex reference internal" href="../zzz_references_html.html#faustoetal2009" id="id10">[1]</a></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.fausto_air_temp.summer_peak_day"><code class="docutils literal notranslate"><span class="pre">summer_peak_day</span></code></a> (196<em> ordinal day number</em>) day of year for July 15; used in corrected formula (4) in <a class="bibtex reference internal" href="../zzz_references_html.html#faustoetal2009" id="id11">[1]</a></p></li>
</ol>
<p>See <a class="reference internal" href="#sec-atmosphere-precip-scaling"><span class="std std-ref">Precipitation correction using scalar temperature offsets</span></a> for an implementation of the SeaRISE-Greenland
formula for precipitation adjustment using air temperature offsets relative to present; a
7.3% change of precipitation rate for every one degree Celsius of temperature change
<a class="bibtex reference internal" href="../zzz_references_html.html#huybrechts02" id="id12">[2]</a>.</p>
</div>
<div class="section" id="pik">
<span id="sec-atmosphere-pik"></span><h2><a class="toc-backref" href="#id29">PIK</a><a class="headerlink" href="#pik" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="option docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">pik</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">lat</span></code>, <code class="variable docutils literal notranslate"><span class="pre">lon</span></code>, <code class="variable docutils literal notranslate"><span class="pre">precipitation</span></code></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::PIK</span></code></p>
</dd>
</dl>
<p>This model component reads a time-independent precipitation field from an input file
specified by <a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.pik.file"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pik</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a> and computes near-surface air temperature using
a parameterization selected using <a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.pik.parameterization"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.pik</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.parameterization</span></code></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Parameterizations implemented in this model are appropriate for the <strong>Antarctic</strong> ice
sheet.</p></li>
<li><p>All parameterizations except for the first one implement a cosine annual cycle of the
near-surface air temperature.</p></li>
</ul>
</div>
<table class="colwidths-given docutils align-default" id="id24">
<caption><span class="caption-number">Table 36 </span><span class="caption-text">Near-surface air temperature parameterizations</span><a class="headerlink" href="#id24" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Keyword</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">martin</span></code> (default)</p></td>
<td><p>Uses equation (1) from <a class="bibtex reference internal" href="../zzz_references_html.html#martinetal2011" id="id13">[3]</a> to parameterize mean annual
temperature with <em>no seasonal variation in temperature.</em></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">huybrechts_dewolde</span></code></p></td>
<td><p>Mean annual and mean summer temperatures are computed using parameterizations for
the Antarctic ice sheet described in <a class="bibtex reference internal" href="../zzz_references_html.html#huybrechtsdewolde" id="id14">[4]</a> (equations C1 and C2).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">martin_huybrechts_dewolde</span></code></p></td>
<td><p>Hybrid of the two above: mean annual temperature as in <a class="bibtex reference internal" href="../zzz_references_html.html#martinetal2011" id="id15">[3]</a> with
the amplitude of the annual cycle from <a class="bibtex reference internal" href="../zzz_references_html.html#huybrechtsdewolde" id="id16">[4]</a>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">era_interim</span></code></p></td>
<td><p>Mean annual and mean summer temperatures use parameterizations based on multiple
regression analysis of ERA INTERIM data.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">era_interim_sin</span></code></p></td>
<td><p>Mean annual and mean summer temperatures use parameterizations based on multiple
regression analysis of ERA INTERIM data with a <span class="math notranslate nohighlight">\(\sin(\text{latitude})\)</span> dependence.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">era_interim_lon</span></code></p></td>
<td><p>Mean annual and mean summer temperatures use parameterizations based on multiple
regression analysis of ERA INTERIM data with a <span class="math notranslate nohighlight">\(\cos(\text{longitude})\)</span> dependence.</p></td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="surface.html#sec-surface-pik"><span class="std std-ref">PIK</span></a> for a surface model that implements the <code class="docutils literal notranslate"><span class="pre">martin</span></code> choice as a
parameterization of the ice temperature at its top surface.</p>
</div>
<div class="section" id="one-weather-station">
<span id="sec-atmosphere-one-station"></span><h2><a class="toc-backref" href="#id30">One weather station</a><a class="headerlink" href="#one-weather-station" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="option docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">one_station</span></code>
<code class="option docutils literal notranslate"><span class="pre">-atmosphere_one_station_file</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">air_temp</span></code> [Kelvin],
<code class="variable docutils literal notranslate"><span class="pre">precipitation</span></code> <span class="math notranslate nohighlight">\(kg / (m^{2} s)\)</span></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::WeatherStation</span></code></p>
</dd>
</dl>
<p>This model component reads scalar time-series of the near-surface air temperature and
precipitation from a file specified using <a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.one_station.file"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.one_station</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a>
and uses them at <em>all</em> grid points in the domain. In other words, resulting climate fields
are constant in space but not necessarily in time.</p>
<p>The <code class="option docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">one_station</span></code> model should be used with a modifier such as
<code class="docutils literal notranslate"><span class="pre">elevation_change</span></code> (see section <a class="reference internal" href="#sec-atmosphere-elevation-change"><span class="std std-ref">Adjustments using modeled change in surface elevation</span></a>) to create spatial
variablitity.</p>
</div>
<div class="section" id="scalar-temperature-offsets">
<span id="sec-atmosphere-delta-t"></span><h2><a class="toc-backref" href="#id31">Scalar temperature offsets</a><a class="headerlink" href="#scalar-temperature-offsets" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">...,delta_T</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">delta_T</span></code></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::Delta_T</span></code></p>
</dd>
</dl>
<p>This modifier applies scalar time-dependent air temperature offsets to the output of an
atmosphere model.</p>
<p>Please make sure that <code class="variable docutils literal notranslate"><span class="pre">delta_T</span></code> has the units of “<code class="docutils literal notranslate"><span class="pre">Kelvin</span></code>”.</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">atmosphere.delta_T.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.delta_T.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing temperature offsets.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.delta_T.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
</ol>
</div>
<div class="section" id="scalar-precipitation-offsets">
<span id="sec-atmosphere-delta-p"></span><h2><a class="toc-backref" href="#id32">Scalar precipitation offsets</a><a class="headerlink" href="#scalar-precipitation-offsets" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="option docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">...,delta_P</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">delta_P</span></code> <span class="math notranslate nohighlight">\(kg / (m^{2} s)\)</span></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::Delta_P</span></code></p>
</dd>
</dl>
<p>This modifier applies scalar time-dependent precipitation offsets to the output of an
atmosphere model.</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">atmosphere.delta_P.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.delta_P.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing scalar precipitation offsets.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.delta_P.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
</ol>
</div>
<div class="section" id="precipitation-scaling">
<span id="sec-atmosphere-frac-p"></span><h2><a class="toc-backref" href="#id33">Precipitation scaling</a><a class="headerlink" href="#precipitation-scaling" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">...,frac_P</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">frac_P</span></code> [1]</p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::Frac_P</span></code></p>
</dd>
</dl>
<p>This modifier scales precipitation output of an atmosphere model using a time-dependent
precipitation fraction, with a value of <em>one</em> corresponding to no change in precipitation.
It supports both 1D (scalar) and 2D (spatially-variable) factors.</p>
<p>If the variable <code class="variable docutils literal notranslate"><span class="pre">frac_P</span></code> in the input file (see <a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.frac_P.file"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.frac_P</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a>) depends
on time only it is used as a time-dependent constant-in-space scaling factor.</p>
<p>If the variable <code class="variable docutils literal notranslate"><span class="pre">frac_P</span></code> has more than one dimension PISM tries to use it as a
time-and-space-dependent scaling factor.</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">atmosphere.frac_P.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.frac_P.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing scalar precipitation scaling.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.frac_P.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
</ol>
</div>
<div class="section" id="precipitation-correction-using-scalar-temperature-offsets">
<span id="sec-atmosphere-precip-scaling"></span><h2><a class="toc-backref" href="#id34">Precipitation correction using scalar temperature offsets</a><a class="headerlink" href="#precipitation-correction-using-scalar-temperature-offsets" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">...,precip_scaling</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">delta_T</span></code> [degrees Kelvin]</p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::PrecipitationScaling</span></code></p>
</dd>
</dl>
<p>This modifier implements the SeaRISE-Greenland formula for a precipitation correction from
present; a 7.3% change of precipitation rate for every one degree Celsius of air
temperature change <a class="bibtex reference internal" href="../zzz_references_html.html#huybrechts02" id="id17">[2]</a>. See <a class="reference external" href="http://websrv.cs.umt.edu/isis/index.php/Model_Initialization#Greenland">SeaRISE Greenland model initialization</a> for details. The input file should contain air temperature offsets
in the format used by <code class="docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">...,delta_T</span></code> modifier, see section <a class="reference internal" href="#sec-atmosphere-delta-t"><span class="std std-ref">Scalar temperature offsets</span></a>.</p>
<p>This mechanisms increases precipitation by <span class="math notranslate nohighlight">\(100(\exp(C) - 1)\)</span> percent for each degree of
temperature increase, where</p>
<p><span class="math notranslate nohighlight">\(C =\)</span> <a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.precip_exponential_factor_for_temperature"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.precip_exponential_factor_for_temperature</span></code></a>.</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">atmosphere.precip_scaling.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.precip_scaling.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing temperature offsets to use for a precipitation correction.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.precip_scaling.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
</ol>
</div>
<div class="section" id="adjustments-using-modeled-change-in-surface-elevation">
<span id="sec-atmosphere-elevation-change"></span><h2><a class="toc-backref" href="#id35">Adjustments using modeled change in surface elevation</a><a class="headerlink" href="#adjustments-using-modeled-change-in-surface-elevation" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="option docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">...,elevation_change</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">surface_altitude</span></code> (CF standard name)</p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::ElevationChange</span></code></p>
</dd>
</dl>
<p>The <code class="docutils literal notranslate"><span class="pre">elevation_change</span></code> modifier adjusts air temperature and precipitation using modeled
changes in surface elevation relative to a reference elevation read from a file.</p>
<p>The near-surface air temperature is modified using an elevation lapse rate <span class="math notranslate nohighlight">\(\gamma_T =\)</span>
<a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.elevation_change.temperature_lapse_rate"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.elevation_change</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.temperature_lapse_rate</span></code></a>. Here</p>
<div class="math notranslate nohighlight">
\[\gamma_T = -\frac{dT}{dz}.\]</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Some atmosphere models (<a class="reference internal" href="#sec-atmosphere-pik"><span class="std std-ref">PIK</span></a>, for example) use elevation-dependent
near-surface air temperature parameterizations that include an elevation lapse rate.</p>
<p>In most cases one should not combine such a temperature parameterization with an
additional elevation lapse rate for temperature.</p>
</div>
<p>Two methods of adjusting precipitation are available:</p>
<ul>
<li><p>Scaling using an exponential factor</p>
<div class="math notranslate nohighlight">
\[\mathrm{P} = \mathrm{P_{input}} \cdot \exp(C \cdot \Delta T),\]</div>
<p>where <span class="math notranslate nohighlight">\(C =\)</span> <a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.precip_exponential_factor_for_temperature"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.precip_exponential_factor_for_temperature</span></code></a> and <span class="math notranslate nohighlight">\(\Delta
T\)</span> is the temperature difference produced by applying the lapse rate
<a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.elevation_change.precipitation.temp_lapse_rate"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.elevation_change</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.precipitation</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.temp_lapse_rate</span></code></a>.</p>
<p>This mechanisms increases precipitation by <span class="math notranslate nohighlight">\(100(\exp(C) - 1)\)</span> percent for each degree of
temperature increase.</p>
<p>To use this method, set <code class="option docutils literal notranslate"><span class="pre">-precip_adjustment</span> <span class="pre">scale</span></code>.</p>
</li>
<li><p>Elevation lapse rate for precipitation</p>
<div class="math notranslate nohighlight">
\[\mathrm{P} = \mathrm{P_{input}} - \Delta h \cdot \gamma_P,\]</div>
<p>where <span class="math notranslate nohighlight">\(\gamma_P =\)</span> <a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.elevation_change.precipitation.lapse_rate"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.elevation_change</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.precipitation</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.lapse_rate</span></code></a> and
<span class="math notranslate nohighlight">\(\Delta h\)</span> is the difference between modeled and reference surface elevations.</p>
<p>To use this method, set <code class="option docutils literal notranslate"><span class="pre">-smb_adjustment</span> <span class="pre">shift</span></code>.</p>
</li>
</ul>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">atmosphere.elevation_change.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.elevation_change.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing the reference surface elevation field (variable <code class="variable docutils literal notranslate"><span class="pre">usurf</span></code>).</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.elevation_change.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.elevation_change.precipitation.lapse_rate"><code class="docutils literal notranslate"><span class="pre">precipitation</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.lapse_rate</span></code></a> (0<em> (kg m-2 / year) / km</em>) Elevation lapse rate for the precipitation</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.elevation_change.precipitation.method"><code class="docutils literal notranslate"><span class="pre">precipitation</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.method</span></code></a> (<code class="docutils literal notranslate"><span class="pre">shift</span></code>) Choose the precipitation adjustment method. <code class="docutils literal notranslate"><span class="pre">scale</span></code>: use temperature-change-dependent scaling factor. <code class="docutils literal notranslate"><span class="pre">shift</span></code>: use the precipitation lapse rate.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.elevation_change.precipitation.temp_lapse_rate"><code class="docutils literal notranslate"><span class="pre">precipitation</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.temp_lapse_rate</span></code></a> (0<em> Kelvin / km</em>) Elevation lapse rate for the surface temperature used to compute <span class="math notranslate nohighlight">\(\Delta T\)</span> in the precipitation scaling factor <span class="math notranslate nohighlight">\(\exp(C \cdot \Delta T)\)</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.elevation_change.temperature_lapse_rate"><code class="docutils literal notranslate"><span class="pre">temperature_lapse_rate</span></code></a> (0<em> Kelvin / km</em>) Elevation lapse rate for the surface temperature</p></li>
</ol>
<p>The file specified using <a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.elevation_change.file"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.elevation_change</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.file</span></code></a> may contain several
surface elevation records to use lapse rate corrections relative to a time-dependent
surface. If one record is provided, the reference surface elevation is assumed to be
time-independent.</p>
</div>
<div class="section" id="using-climate-data-anomalies">
<span id="sec-atmosphere-anomaly"></span><h2><a class="toc-backref" href="#id36">Using climate data anomalies</a><a class="headerlink" href="#using-climate-data-anomalies" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="option docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">...,anomaly</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p><code class="variable docutils literal notranslate"><span class="pre">air_temp_anomaly</span></code>,
<code class="variable docutils literal notranslate"><span class="pre">precipitation_anomaly</span></code> <span class="math notranslate nohighlight">\(kg / (m^{2} s)\)</span></p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::Anomaly</span></code></p>
</dd>
</dl>
<p>This modifier implements a spatially-variable version of <code class="docutils literal notranslate"><span class="pre">-atmosphere</span>
<span class="pre">...,delta_T,delta_P</span></code>.</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">atmosphere.anomaly.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.anomaly.file"><code class="docutils literal notranslate"><span class="pre">file</span></code></a> Name of the file containing climate forcing fields.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.anomaly.periodic"><code class="docutils literal notranslate"><span class="pre">periodic</span></code></a> (no) If true, interpret forcing data as periodic in time</p></li>
</ol>
<p>See also to <code class="docutils literal notranslate"><span class="pre">-surface</span> <span class="pre">...,anomaly</span></code> (section <a class="reference internal" href="surface.html#sec-surface-anomaly"><span class="std std-ref">Using climate data anomalies</span></a>), which is
similar but applies anomalies at the surface level.</p>
</div>
<div class="section" id="orographic-precipitation">
<span id="sec-orographic-precipitation"></span><h2><a class="toc-backref" href="#id37">Orographic precipitation</a><a class="headerlink" href="#orographic-precipitation" title="Permalink to this headline">¶</a></h2>
<dl class="field-list simple">
<dt class="field-odd">Options</dt>
<dd class="field-odd"><p><code class="option docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">...,orographic_precipitation</span></code></p>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">C++ class</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">pism::atmosphere::OrographicPrecipitation</span></code></p>
</dd>
</dl>
<p>This modifier implements the linear orographic precipitation model described in
<a class="bibtex reference internal" href="../zzz_references_html.html#smithbarstad2004" id="id18">[5]</a> with a modification incorporating the influence of the Coriolis
force from <a class="bibtex reference internal" href="../zzz_references_html.html#smithbarstadbonneau2005" id="id19">[6]</a>.</p>
<p>We compute the Fourier transform of the precipitation field using the formula below (see
equation 49 in <a class="bibtex reference internal" href="../zzz_references_html.html#smithbarstad2004" id="id20">[5]</a> or equation 3 in <a class="bibtex reference internal" href="../zzz_references_html.html#smithbarstadbonneau2005" id="id21">[6]</a>).</p>
<div class="math notranslate nohighlight" id="equation-eq-orographic-precipitation">
<span class="eqno">(43)<a class="headerlink" href="#equation-eq-orographic-precipitation" title="Permalink to this equation">¶</a></span>\[\hat P_{\text{LT}}(k, l) = \frac{C_w i \sigma \hat h(k, l)}
{(1 - i m H_w) (1 + i \sigma \tau_c) (1 + i \sigma \tau_f)},\]</div>
<p>where <span class="math notranslate nohighlight">\(h\)</span> is the surface elevation, <span class="math notranslate nohighlight">\(C_w = \rho_{S_{\text{ref}}} \Gamma_m / \gamma\)</span>
relates the condensation rate to vertical motion (see the appendix of
<a class="bibtex reference internal" href="../zzz_references_html.html#smithbarstad2004" id="id22">[5]</a>), <span class="math notranslate nohighlight">\(m\)</span> is the vertical wavenumber (see equation 6 in
<a class="bibtex reference internal" href="../zzz_references_html.html#smithbarstadbonneau2005" id="id23">[6]</a>), and <span class="math notranslate nohighlight">\(\sigma\)</span> is the intrinsic frequency. The rest of the
constants are defined below.</p>
<p>The spatial pattern of precipitation is recovered using an inverse Fourier transform
followed by post-processing:</p>
<div class="math notranslate nohighlight" id="equation-eq-orographic-post-processing">
<span class="eqno">(44)<a class="headerlink" href="#equation-eq-orographic-post-processing" title="Permalink to this equation">¶</a></span>\[P = \max(P_{\text{pre}} + P_{\text{LT}}, 0) \cdot S + P_{\text{post}}.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul>
<li><p>Discontinuities in the surface gradient (e.g. at ice margins) may cause oscillations
in the computed precipitation field (probably due to the Gibbs phenomenon). To address
this our implementation includes the ability to smooth the surface topography using a
Gaussian filter. Set
<a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.smoothing_standard_deviation"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.orographic_precipitation</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.smoothing_standard_deviation</span></code></a> to a
positive number to enable smoothing. Values around <span class="math notranslate nohighlight">\(\dx\)</span> appear to be effective.</p></li>
<li><p>The spectral method used to implement this model requires that the input (i.e.
surface elevation <span class="math notranslate nohighlight">\(h\)</span>) is periodic in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>. To simulate periodic <span class="math notranslate nohighlight">\(h\)</span> the
implementation uses an extended grid (see
<a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.grid_size_factor"><code class="docutils literal notranslate"><span class="pre">atmosphere</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.orographic_precipitation</span></code>&shy;<code class="docutils literal notranslate"><span class="pre">.grid_size_factor</span></code></a>) and pads modeled
surface elevation with zeros.</p>
<p>It is worth noting that the resulting precipitation field <span class="math notranslate nohighlight">\(P_{\text{LT}}\)</span> <em>is also
periodic</em> in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> on the <em>extended</em> grid. The appropriate size of this
extended grid may differ depending on the spatial scale of the domain and values of
model parameters.</p>
</li>
</ul>
</div>
<p>It is implemented as a “modifier” that overrides the precipitation field provided by an
input model. Use it with a model providing air temperatures to get a complete model. For
example, <code class="docutils literal notranslate"><span class="pre">-atmosphere</span> <span class="pre">yearly_cycle,orographic_precipitation</span> <span class="pre">...</span></code> would use the annual
temperature cycle from <code class="docutils literal notranslate"><span class="pre">yearly_cycle</span></code> combined with precipitation computed using this
model.</p>
<p>The only spatially-variable input of this model is the surface elevation (<span class="math notranslate nohighlight">\(h\)</span> above)
modeled by PISM.</p>
<p class="rubric">Parameters</p>
<p>Prefix: <code class="docutils literal notranslate"><span class="pre">atmosphere.orographic_precipitation.</span></code></p>
<ol class="simple">
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.background_precip_post"><code class="docutils literal notranslate"><span class="pre">background_precip_post</span></code></a> (0<em> mm/hr</em>) Background precipitation <span class="math notranslate nohighlight">\(P_{\mathrm{post}}\)</span> added after the truncation.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.background_precip_pre"><code class="docutils literal notranslate"><span class="pre">background_precip_pre</span></code></a> (0<em> mm/hr</em>) Background precipitation <span class="math notranslate nohighlight">\(P_{\mathrm{pre}}\)</span> added before the truncation.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.conversion_time"><code class="docutils literal notranslate"><span class="pre">conversion_time</span></code></a> (1000<em> s</em>) Cloud conversion time <span class="math notranslate nohighlight">\(\tau_c\)</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.coriolis_latitude"><code class="docutils literal notranslate"><span class="pre">coriolis_latitude</span></code></a> (0<em> degrees_N</em>) Latitude used to compute Coriolis force</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.fallout_time"><code class="docutils literal notranslate"><span class="pre">fallout_time</span></code></a> (1000<em> s</em>) Fallout time <span class="math notranslate nohighlight">\(\tau_f\)</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.grid_size_factor"><code class="docutils literal notranslate"><span class="pre">grid_size_factor</span></code></a> (2) The size of the extended grid is <code class="docutils literal notranslate"><span class="pre">(Z*(grid.Mx</span> <span class="pre">-</span> <span class="pre">1)</span> <span class="pre">+</span> <span class="pre">1,</span> <span class="pre">Z*(grid.My</span> <span class="pre">-</span> <span class="pre">1)</span> <span class="pre">+</span> <span class="pre">1)</span></code> where <code class="docutils literal notranslate"><span class="pre">Z</span></code> is given by this parameter.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.lapse_rate"><code class="docutils literal notranslate"><span class="pre">lapse_rate</span></code></a> (-5.8<em> K / km</em>) Lapse rate <span class="math notranslate nohighlight">\(\gamma\)</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.moist_adiabatic_lapse_rate"><code class="docutils literal notranslate"><span class="pre">moist_adiabatic_lapse_rate</span></code></a> (-6.5<em> K / km</em>) Moist adiabatic lapse rate <span class="math notranslate nohighlight">\(\Gamma_m\)</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.moist_stability_frequency"><code class="docutils literal notranslate"><span class="pre">moist_stability_frequency</span></code></a> (0.05<em> 1/s</em>) Moist stability frequency <span class="math notranslate nohighlight">\(N_m\)</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.reference_density"><code class="docutils literal notranslate"><span class="pre">reference_density</span></code></a> (0.0074<em> kg m-3</em>) Reference density <span class="math notranslate nohighlight">\(\rho_{S_{\text{ref}}}\)</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.scale_factor"><code class="docutils literal notranslate"><span class="pre">scale_factor</span></code></a> (1) Precipitation scaling factor <span class="math notranslate nohighlight">\(S\)</span>.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.smoothing_standard_deviation"><code class="docutils literal notranslate"><span class="pre">smoothing_standard_deviation</span></code></a> (0<em> m</em>) Standard deviation of the Gaussian filter used to smooth surface elevation or zero if disabled</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.truncate"><code class="docutils literal notranslate"><span class="pre">truncate</span></code></a> (true) Truncate precipitation at 0, disallowing negative precipitation values.</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.water_vapor_scale_height"><code class="docutils literal notranslate"><span class="pre">water_vapor_scale_height</span></code></a> (2500<em> m</em>) Water vapor scale height <span class="math notranslate nohighlight">\(H_w\)</span></p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.wind_direction"><code class="docutils literal notranslate"><span class="pre">wind_direction</span></code></a> (270<em> degrees</em>) The direction the wind is coming from</p></li>
<li><p><a class="reference internal" href="../manual/parameters/index.html#config-atmosphere.orographic_precipitation.wind_speed"><code class="docutils literal notranslate"><span class="pre">wind_speed</span></code></a> (10<em> m/s</em>) The wind speed.</p></li>
</ol>
</div>
</div>


      <hr>
      <table style="width: 100%">
        <tr>
          <td style="text-align: left; width: 30%">
              <a class="reference internal" href="surface.html">Previous</a>
          </td>
          <td style="text-align: center; width: 30%">
              <a class="reference internal" href="index.html">Up</a>
          </td>
          <td style="text-align: right; width: 30%">
              <a class="reference internal" href="ocean.html">Next</a>
          </td>
        </tr>
      </table>
    </div>
  </div>
</div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/pism-logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Installing PISM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../manual/index.html">PISM User’s Manual</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Climate forcing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="time-dependent.html">Using time-dependent forcing</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples.html">Examples and corresponding options</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing if forcing data is used correctly</a></li>
<li class="toctree-l2"><a class="reference internal" href="surface.html">Surface mass and energy process model components</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Atmosphere model components</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reading-boundary-conditions-from-a-file">Reading boundary conditions from a file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cosine-yearly-cycle">Cosine yearly cycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sec-atmosphere-searise-greenland">SeaRISE-Greenland</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pik">PIK</a></li>
<li class="toctree-l3"><a class="reference internal" href="#one-weather-station">One weather station</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scalar-temperature-offsets">Scalar temperature offsets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#scalar-precipitation-offsets">Scalar precipitation offsets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#precipitation-scaling">Precipitation scaling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#precipitation-correction-using-scalar-temperature-offsets">Precipitation correction using scalar temperature offsets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adjustments-using-modeled-change-in-surface-elevation">Adjustments using modeled change in surface elevation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-climate-data-anomalies">Using climate data anomalies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#orographic-precipitation">Orographic precipitation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ocean.html">Ocean model components</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../technical/index.html">Technical notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contributing to PISM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authorship.html">Authorship</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zzz_references_html.html">References</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      Git revision v2.0.3-16-gad24975a0
      committed by Constantine Khrulev
      on 2022-05-25 10:48:10 -0800 |
      &copy; 2004--2022, the PISM authors.
      
    </div>
  </body>
</html>